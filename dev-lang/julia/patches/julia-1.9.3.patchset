From b7c22eecc35eab9394c8130fcfddef1fd1efa439 Mon Sep 17 00:00:00 2001
From: Begasus <begasus@gmail.com>
Date: Mon, 4 Sep 2023 12:51:39 +0200
Subject: Build fixes


diff --git a/cli/loader_lib.c b/cli/loader_lib.c
index 2043473..0d5d618 100644
--- a/cli/loader_lib.c
+++ b/cli/loader_lib.c
@@ -7,6 +7,10 @@
 extern "C" {
 #endif
 
+#ifndef RTLD_NOLOAD
+    #define RTLD_NOLOAD 0
+#endif
+
 /* Bring in definitions of symbols exported from libjulia. */
 #include "jl_exports.h"
 
diff --git a/deps/libwhich.version b/deps/libwhich.version
index 0fa7130..09ea019 100644
--- a/deps/libwhich.version
+++ b/deps/libwhich.version
@@ -1,2 +1,2 @@
 LIBWHICH_BRANCH=master
-LIBWHICH_SHA1=81e9723c0273d78493dc8c8ed570f68d9ce7e89e
+LIBWHICH_SHA1=99a0ea12689e41164456dba03e93bc40924de880
-- 
2.37.3


From cdbb0f9a46a4802cbadf1f95f12e2467486c189f Mon Sep 17 00:00:00 2001
From: Begasus <begasus@gmail.com>
Date: Mon, 4 Sep 2023 13:08:45 +0200
Subject: Disable CMAKE_POSITION_INDEPENDENT_CODE


diff --git a/deps/zlib.mk b/deps/zlib.mk
index 5548a07..c4c0e38 100644
--- a/deps/zlib.mk
+++ b/deps/zlib.mk
@@ -6,7 +6,7 @@ $(eval $(call git-external,zlib,ZLIB,,,$(SRCCACHE)))
 
 # use `-DUNIX=true` to ensure that it is always named `libz`
 ZLIB_BUILD_OPTS := $(CMAKE_COMMON) -DCMAKE_BUILD_TYPE=Release -DUNIX=true
-ZLIB_BUILD_OPTS += -DCMAKE_POSITION_INDEPENDENT_CODE=ON
+ZLIB_BUILD_OPTS += -DCMAKE_POSITION_INDEPENDENT_CODE=OFF
 
 $(BUILDDIR)/$(ZLIB_SRC_DIR)/build-configured: $(SRCCACHE)/$(ZLIB_SRC_DIR)/source-extracted
 	mkdir -p $(dir $@)
-- 
2.37.3

